<!DOCTYPE html>
<!--
    Forty by HTML5 UP
    html5up.net | @ajlkn
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
  -->
<html>

  <head>
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-6YNFJY0416"></script>
	<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'G-6YNFJY0416');
	</script>
	<title>Setting QuantLib up in my laptop, again. An amazing tool for quants. | Cristian</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js"></script><![endif]-->
	<link rel="stylesheet" href="/assets/css/main.css" />
	<!--[if lte IE 9]><link rel="stylesheet" href="/assets/css/ie9.css" /><![endif]-->
	<!--[if lte IE 8]><link rel="stylesheet" href="/assets/css/ie8.css" /><![endif]-->
	<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicon_io/facapple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon_io/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon_io/favicon-16x16.png">
	<link rel="manifest" href="/assets/images/favicon_io/site.webmanifest">
</head>


  <body class="layout-post">

    <!-- Wrapper -->
<div id="wrapper">

<!-- Header -->
<header id="header">
	<a href="/" class="logo"><strong>Cristian</strong> <span>Quintero</span></a>
	<nav>
		<a href="#menu">Menu</a>
	</nav>
</header>

<!-- Menu -->
<nav id="menu">
	<ul class="links">
        
		    
		
		    
		
		    
		
		    
		        <li><a href="/">Home</a></li>
	    	
		
		    
		
		    
		
		    
		
		
		    
		
		    
		        <li><a href="/about_me.html">About Me</a></li>
		    
		
		    
		        <li><a href="/all_posts.html">All posts</a></li>
		    
		
		    
		
		    
		        <li><a href="/my_posts.html">My posts</a></li>
		    
		
		    
		        <li><a href="/whatilike.html">I like</a></li>
		    
		
	</ul>
	<ul class="actions vertical">
		<li><a href="#" class="button special fit">Get Started</a></li>
		<li><a href="#" class="button fit">Log In</a></li>
	</ul>
</nav>
 
    
    <!-- Enhanced Sidebar with Category-specific Posts -->
    
      
        
          
          
          
    
    <aside id="sidebar" class="sidebar">
      <div class="sidebar-content">
        
          <div class="sidebar-category-header">
            <h3>Quantitative Development</h3>
            <div class="category-indicator"></div>
          </div>
          <h4>Posts in this Category</h4>
          <ul class="recent-posts">
            
            
            
              <li class="recent-post-item">
                <a href="/quantitative%20development/2025/06/29/ai_agent_for_quants.html" class="recent-post-link">
                  
                    <div class="recent-post-image">
                      <img src="/assets/images/04_llm_and_mcp/jarvis_.jpg" alt="What about AI Agents for Quants?" />
                    </div>
                  
                  <div class="recent-post-content">
                    <h5>What about AI Agents for Quants?</h5>
                    
                      <span class="recent-post-date">Jun 29, 2025</span>
                    
                  </div>
                </a>
              </li>
            
            
          </ul>
          
          <!-- Show link to all posts in this category -->
          <div class="sidebar-category-link">
            <a href="/my_posts.html" class="view-all-category">
              View All Quantitative Development Posts ‚Üí
            </a>
          </div>
        
      </div>
    </aside>

    <!-- Sidebar toggle for mobile -->
    <button id="sidebar-toggle" class="sidebar-toggle" aria-label="Toggle sidebar">
      <i class="fa fa-bars"></i>
    </button>
    
    <!-- Sidebar overlay for mobile -->
    <div id="sidebar-overlay" class="sidebar-overlay"></div>
    
    <!-- Table of Contents Sidebar -->
    <button id="toc-toggle" class="toc-toggle" title="Show/Hide Table of Contents" aria-label="Show/Hide Table of Contents">
      <span aria-hidden="true">üìë</span>
    </button>
    <nav id="toc-sidebar" class="toc-sidebar"></nav>

    <!-- Main -->
    <div id="main" class="alt">

      <!-- One -->
      <section id="one">
	<div class="inner">
		
			
        
          <header class="major">
            <h1>Setting QuantLib up in my laptop, again. An amazing tool for quants.</h1>
          </header>
          
            <div class="post-image-container">
              <img src="/assets/images/01_post_images/004_quant_developer/00_circuit.jpg" alt="Setting QuantLib up in my laptop, again. An amazing tool for quants." />
            </div>
          
          <p>Aug 10, 2025</p>
          <p><p>Recently I‚Äôve decided to run the maintainance of my laptop, just to remove files I no longer use and that are hidden because I moved somewhere and I don‚Äôt remember where. Naturally, every time I have to set it up again. That‚Äôs why this post is a reminder of how to setting up the <a href="https://www.quantlib.org/docs.shtml" target="_blank" rel="noopener">QuantLib</a> library, since I think is one of the most nice libraries in scope of quantitative finance. This library covers different instruments, pricing engines and more, developed by following an architecture that has evolved over time, as pointed out in <a href="https://leanpub.com/implementingquantlib/" target="_blank" rel="noopener">Luigi Ballabio‚Äôs book</a>. I strongly encorage the readers to read the book, where Luigi walk you throug design patterns and reasoning for implementing them. In my opinion this approach, although far from being perfect, is a really good approximation to the <a href="https://math.ucr.edu/home/baez/physics/General/occam.html" target="_blank" rel="noopener">Occam‚Äôs Razor</a>, where parsimony is our allie. Different concepts are discussed in there. Concepts that I‚Äôd like to dive deep into later on in another post. At the moment, let‚Äôs see how to use the library if you love, as I do, dive into details of quantitative finance via well designed tools.</p>

<h1 id="quantlib">QuantLib</h1>
<p>QuantLib is a free/open-source library for quantitative finance, as <a href="https://www.quantlib.org/" target="_blank" rel="noopener">it‚Äôs webpage</a> starts saying. It is coded essencially in C++, see <a href="https://github.com/lballabio/quantlib" target="_blank" rel="noopener">QuantLib Github repository</a>. Some non-quants may blank their eyes and say <strong>‚Äúit‚Äôs hard to learn‚Äù</strong>. But here is where things get better, because the library is also exposed to Python via <a href="https://www.swig.org/" target="_blank" rel="noopener">Swig</a>, see <a href="https://github.com/lballabio/QuantLib-SWIG" target="_blank" rel="noopener">QuantLib-Swig repository</a>. Amazing, right?.</p>

<p>It‚Äôs not necessary that you try to understand how programming languages are linked with a very big project as QuantLib. Instead, you could take a look into a very straightforward example I prepared a couple of years ago <a href="https://github.com/craquinterogo/quantitative_finance/tree/master/Derivatives" target="_blank" rel="noopener">here</a>.</p>

<p>Frequent posts are published by Luigi <a href="https://implementingquantlib.substack.com/" target="_blank" rel="noopener">here</a>, in case you want to stay tuned with tips and tricks to work with the library. Also new releases are notified, among other channels, there.</p>

<h2 id="quantlib-c">QuantLib C++</h2>
<p>The core is documented <a href="https://www.quantlib.org/reference/index.html">here</a>, besides QuantLib books. People not involved in C++ coding may feel overwhelmed as the library is comprised a many classes, design patterns, pricing engines and financial instruments. Moreover, diversity is what makes QuantLib a nice tool for quants, since with variety of instruments and payoffs we can build synthetic pay-offs.</p>

<h2 id="quantlib-python">QuantLib Python</h2>
<p>Don‚Äôt cry, baby, don‚Äôt cry. There is a layer on top C++ codes, that exposes the library to Python programming language. This is done by means <a href="https://www.swig.org/" target="_blank" rel="noopener">Swig</a>, which is <em>‚Äúa software development tool that connects programs coded C/C++ with high-level programming languages‚Äù</em>. I think the reader starts seeing what is this about.</p>

<h2 id="why">Why?</h2>
<p>With the architectural design, implemented to optimize classes and data resource consumption, all coded in C++ in spite the programming language challenges, allows to build on top thereof. This approach keeps a single point for developing, with top layers enabling users to connect without losing core functionalities. That‚Äôs what I infer at least, perhaps we can ask Luigi and library‚Äôs contributors to confirm or challenging this assumption.</p>

<h1 id="installation">Installation</h1>
<p>I forgot to mention that my OS is one of Linux family, that I prefer since it allows more control on OS setup. Therefore, the instructions described in here are mainly useful for this operating systems. Nonetheless, as this instructions use tools also available in other OSs, such as <a href="https://cmake.org/" target="_blank" rel="noopener">CMake</a> or <a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a>, readers likely wouldn‚Äôt find any problem replicating in their respective OS. <strong>Following steps correspond only to QuantLib install, no any other installation is covered, for instance CMake, Git, C++ compiler, Boost lib and others</strong>.</p>

<h2 id="cloning-quantlib-repository">Cloning QuantLib repository</h2>
<p>Using <a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a> we can open a terminal to clone the repository. My preference is creating a folder fully dedicated to Git specific projects, reason why commands listed here run within such a folder. Readers can choose based on their own preferences.</p>

<blockquote>
  <p>‚ö†Ô∏è <strong>Warning</strong> :: Recall that if you want to work with the library by modifying it for your own project, it‚Äôs better to <a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/working-with-forks/fork-a-repo" target="_blank" rel="noopener">fork the repository</a> and then cloning your forked repository in your laptop, instead of cloning QuantLib repository directly.</p>
</blockquote>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>git clone https://github.com/lballabio/QuantLib.git
</code></pre></div></div>

<p>Once this command is executed, all the codes in QuantLib github repository will be copied into your laptop. The project contains a lot of files, including not only C++ files -source code and headers-, but also configuration files such as <code class="language-plaintext highlighter-rouge">CMaLists.txt</code> or <code class="language-plaintext highlighter-rouge">QuantLib.vcxproj</code>. The former is the one I‚Äôll use here, but reader if working in Windows, with access to Visual Studio may run the later.</p>

<h2 id="folder-directories">Folder directories</h2>
<p>As you may be eager for running the library for then playing with it, I‚Äôm going to take only few sentences to point out relevant folders.</p>

<h3 id="core-folder">Core folder</h3>
<p>The core of the library is within a folder called <code class="language-plaintext highlighter-rouge">/ql</code> that is comprised by subfolders in charge of many different thigs such as:</p>

<ul>
  <li>Design pattern classes <code class="language-plaintext highlighter-rouge">/patterns</code> (<code class="language-plaintext highlighter-rouge">LazyObject</code>,<code class="language-plaintext highlighter-rouge">Observable</code> or <code class="language-plaintext highlighter-rouge">Singleton</code>, for instance)</li>
  <li>Financial instruments supported <code class="language-plaintext highlighter-rouge">/instruments</code></li>
  <li>Term structure classes <code class="language-plaintext highlighter-rouge">/termstructures</code></li>
  <li>Cashflows modelling <code class="language-plaintext highlighter-rouge">/cashflows</code></li>
  <li>Stochastic processes <code class="language-plaintext highlighter-rouge">/processes</code></li>
  <li>Pricing engines <code class="language-plaintext highlighter-rouge">/pricingengines</code></li>
  <li>Others</li>
</ul>

<h3 id="examples-folder">Examples folder</h3>
<p>The <code class="language-plaintext highlighter-rouge">/Examples</code> folder contains different examples for pricing diverse type of instruments in C++. You‚Äôll see that each example contains its own <code class="language-plaintext highlighter-rouge">.vcxproj</code> file, that can be individually executed in Visual Studio. Moreover, <code class="language-plaintext highlighter-rouge">CMakeLists.txt</code> file is also allocated within each subfolder of examples, and it allows to run the examples once the library has been installed (Installation step described later on here).</p>

<h3 id="documentation">Documentation</h3>
<p>Similar documentation as observed in <a href="https://www.quantlib.org/reference/index.html" target="_blank" rel="noopener">Official website</a> can be reproduced and extended with files in folder named <code class="language-plaintext highlighter-rouge">\Docs</code>. This folder contains a make file named <code class="language-plaintext highlighter-rouge">MakeFile.am</code> that is responsible for documentation generation by executing the command below, preferibly in your own <code class="language-plaintext highlighter-rouge">\build</code> folder, that I‚Äôll refer to later as well.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">make docs
</span></code></pre></div></div>

<p>By running the documentation it will generates a set of <code class="language-plaintext highlighter-rouge">*.html</code> files that can be easily navigated by any library user.</p>

<h3 id="docker-approach">Docker approach</h3>
<p>In case you want to bear a container approach for your projects or your systems, it is also allowed to do so using the docker file named <code class="language-plaintext highlighter-rouge">ci.Dockerfile</code>, quite usefull for <a href="https://www.atlassian.com/continuous-delivery/continuous-integration" target="_blank" rel="noopener">continuous integration or CI</a>. This file is allocated in <code class="language-plaintext highlighter-rouge">\dockerfiles</code> folder.</p>

<h2 id="installing-quantlib">Installing QuantLib</h2>
<p>Once you are familiarized with main folders, I can proceed with how I do install the library. Before, I want to highlight two points.</p>
<ul>
  <li>This approach will create a compiled library which means will compile QuantLib code generating a <code class="language-plaintext highlighter-rouge">libQuantLib.so</code> file (this is the shared library yielded in Linux OS), together with the respective headers that can be used by including them in any other project‚Äôs compilation using QuantLib (or your experimental version).</li>
  <li>It is true that <strong>you don‚Äôt need to compile QuantLib code</strong> if you use package managers such as <a href="https://conan.io/" target="_blank" rel="noopener">Conan</a> or <a href="https://vcpkg.io/en/" target="_blank" rel="noopener">VCPKG</a>. Nonetheless, I hope you‚Äôre also into in Quantitative Finance as I do, just to have time to play and experiment with extra models/methods. If the last is also your case, you‚Äôll need to compile the library with your changes and install it, as I‚Äôll show below.</li>
</ul>

<h3 id="cmake-approach">CMake approach</h3>
<p>Due to I do work in Linux, my personal preference is to use CMake for compiling C++ projects, given the portability and easy use for compiling structured C++ projects. As such, I‚Äôll refer to the <code class="language-plaintext highlighter-rouge">CMakeLists.txt</code> in the root folder where you cloned QuantLib repository. This file contains all the instructions for compiling QuantLib codes. I guess you agree on that describing the content is out of scope this instructions, so I‚Äôll skip its content description. Just keep in mind that this file is core for compilation and installation under this approach.</p>

<h4 id="compilation-setup">Compilation Setup</h4>
<p>Then what we have to do is to create a folder that is used as a temporal folder allocating any temporary file required for compiling and then installating. This folder is commonly named as <code class="language-plaintext highlighter-rouge">\build</code>, and it is located at the same level of <code class="language-plaintext highlighter-rouge">\ql</code> folder. Then we‚Äôll get into this folder in the terminal to start the process, as follows.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span><span class="nb">mkdir </span>build
<span class="gp">&gt;</span><span class="w"> </span><span class="nb">cd </span>build
<span class="gp">&gt;</span><span class="w"> </span>cmake .. <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>Release <span class="nt">-DBUILD_SHARED_LIBS</span><span class="o">=</span>ON <span class="nt">-DCMAKE_INSTALL_PREFIX</span><span class="o">=</span><span class="nv">$HOME</span>/quantlib-install
</code></pre></div></div>

<p>As you noticed, CMake requires have already been installed, since third line uses CMake‚Äôs command line interface to do prepare files for compilation. Additionally, I‚Äôm using three CMake flags <a href="https://cmake.org/cmake/help/latest/variable/CMAKE_BUILD_TYPE.html" target="_blank" rel="noopener">DCMAKE_BUILD_TYPE</a>, <a href="https://cmake.org/cmake/help/latest/variable/BUILD_SHARED_LIBS.html" target="_blank" rel="noopener">DBUILD_SHARED_LIBS</a>, and <a href="https://cmake.org/cmake/help/latest/variable/CMAKE_INSTALL_PREFIX.html" target="_blank" rel="noopener">DCMAKE_INSTALL_PREFIX</a>. I‚Äôll skip the first two, as the reader may refer the official documentation in the link. Nevertheless, I want to emphasize in the third one. <code class="language-plaintext highlighter-rouge">DCMAKE_INSTALL_PREFIX</code> parameter is in charge of configuring the folder where the library will be installed, then it can be modified as user wishes, but keeping into account that <strong>you have to remember this path since it will be called by other projects when refering to QuantLib classes</strong>.</p>

<p>Furthermore, if you paid attention, there is a <code class="language-plaintext highlighter-rouge">..</code> in the command. This means CMake will look for the <code class="language-plaintext highlighter-rouge">CMakeLists.txt</code> in parent folder respect to the folder in the terminal. As I‚Äôm executing this command within <code class="language-plaintext highlighter-rouge">\build</code> folder, it means CMake will look for the <code class="language-plaintext highlighter-rouge">CMakeLists.txt</code> in the root QuantLib folder where I cloned the repository using Git.</p>

<h4 id="compilation">Compilation</h4>
<p>Once executed, the folder <code class="language-plaintext highlighter-rouge">\build</code> will contains the setup files needed to compile the solution. <strong>So far, this files are not QuantLib‚Äôs compiled files</strong>. Then to proceed with compiling the files to then generating our <strong>shared library</strong> and respective headers, we need to run the command below.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>make
</code></pre></div></div>

<blockquote>
  <p>‚òïüçµ <strong>Tip</strong> :: Now, please go and grab a cup of coffee or tea, because it will take a while. You‚Äôll see how the progess is indicated in the terminal going through QuantLib targets, setup in CMake files, as shown below.</p>
</blockquote>

<p align="center">
    <img src="/assets/images/01_post_images/004_quant_developer/001_make_quantlib.png" alt="Calling MCP Server" />
</p>

<p><strong>Easy peasy lemon squeezy!!</strong>. So far, at least, we can rely on CMake configuration that QuantLib contributors have built for us, such that we don‚Äôt need to do any extra to compile the codes. As a result, we‚Äôll be able to see extra folders within <code class="language-plaintext highlighter-rouge">\build</code> folder, such as <code class="language-plaintext highlighter-rouge">\ql</code> (again?), <code class="language-plaintext highlighter-rouge">\Testing</code>, <code class="language-plaintext highlighter-rouge">\Examples</code>, and more. But lets pay attention to a relevant thing, for understanding what‚Äôs going on.</p>

<p>If you take a look in <code class="language-plaintext highlighter-rouge">\build\ql</code> folder, you‚Äôll see that sub-folders structure is pretty similar to the one observed in <code class="language-plaintext highlighter-rouge">\ql</code> folder. <strong>Why?</strong>. Well, that‚Äôs the C++ and CMake magic. When compiled the codes, CMake has copied the headers (<code class="language-plaintext highlighter-rouge">.h/.hpp</code> files) of the library, as they will be installed together with <code class="language-plaintext highlighter-rouge">\build\ql\libQuantLib.so</code>. We could consider <code class="language-plaintext highlighter-rouge">\build</code> folder content as a pre-stage to install.</p>

<blockquote>
  <p>‚ö†Ô∏è <strong>Warning</strong> :: Recall that when creating the shared library, the headers are not within the shared/static library. Then, any other program that needs to communicate with the library requires to <code class="language-plaintext highlighter-rouge">#include</code> the library‚Äôs headers.</p>
</blockquote>

<h4 id="installing">Installing</h4>
<p>Now the last step to finally install the library is running the command below. Recall executing it being in the terminal within <code class="language-plaintext highlighter-rouge">\build</code> folder.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>make <span class="nb">install</span>
</code></pre></div></div>

<blockquote>
  <p>‚ö†Ô∏è <strong>Warning</strong> :: This is crucial, because here is where <code class="language-plaintext highlighter-rouge">DCMAKE_INSTALL_PREFIX</code> parameter acts. During installation, the headers and shared library will be installed in linux within the directory you have setup in this parameter. Then, as the value started with <strong>$HOME</strong>, will means the user home directory will be used to install the library. If you don‚Äôt know which directory is that, just run in the terminal the command <code class="language-plaintext highlighter-rouge">echo $HOME</code>, that shows the respective folder.</p>
</blockquote>

<p>You can check the installation of the library just by running the following commands.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span><span class="nb">cd</span> <span class="nv">$HOME</span>/quantlib-install
<span class="gp">&gt;</span><span class="w"> </span><span class="nb">ls</span>
</code></pre></div></div>

<p>First command will redirect to the folder where QuantLib has been installed, and second one will list the content of that folder. As result, you should be able to see three folders.</p>

<table>
  <thead>
    <tr>
      <th>Folder</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">\bin</code></td>
      <td>Contains additional executables, not needed at the moment for us.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">\include</code></td>
      <td>‚úÖ This folder internally contains a subfolder named <code class="language-plaintext highlighter-rouge">\ql</code>, that stores all the headers required by any other C++ project to interact with QuantLib library just installed.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">lib</code></td>
      <td>‚úÖ  Contains all elements associated with the <strong>shared library</strong> named <code class="language-plaintext highlighter-rouge">libQuantLib.so</code></td>
    </tr>
  </tbody>
</table>

<p>This folders will be used to test our installation.</p>

<h1 id="testing-quantlib-install">Testing QuantLib install</h1>
<p>For testing the install of QuantLib library in our laptop we can replicate the code below. Any doubt you can refer to QuantLib documentation and also <code class="language-plaintext highlighter-rouge">\Example</code> folder. In this ocassion I want to price a fixed-rate bond, but you can try with any other instrument modelled.</p>

<p><strong>Having followed the steps above, we can now move to any other folder, as you wish, to create new code for testing the appropriate installation of the library.</strong>. Then proceed following forthcoming steps in this new folder <strong>apart from</strong> any other folder related to QuantLib library.</p>

<h2 id="cmake-configuration">CMake configuration</h2>
<p>As I mentioned before, CMake is a tool that facilitates many tasks, when referred to C++ code compilation. For that reason I prefer to explain this example using it, also because let us to identify the blocks required for any C++ code that makes use of QuantLib (When not having Visual Studio).</p>

<p>Then, in this new location, we can create a file named <code class="language-plaintext highlighter-rouge">CMakeLists.txt</code>. The content of this file is detailed below.</p>

<div class="language-cmake highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cmake_minimum_required</span><span class="p">(</span>VERSION 3.10<span class="p">)</span>
<span class="nb">project</span><span class="p">(</span>TestingQuantLib<span class="p">)</span>

<span class="nb">set</span><span class="p">(</span>CMAKE_CXX_STANDARD 17<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>CMAKE_CXX_STANDARD_REQUIRED ON<span class="p">)</span>

<span class="nb">add_executable</span><span class="p">(</span>main main.cpp<span class="p">)</span>

<span class="nb">set</span><span class="p">(</span>QUANTLIB_INCLUDE_DIR <span class="s2">"$ENV{HOME}/quantlib-install/include"</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>QUANTLIB_LIB_DIR <span class="s2">"$ENV{HOME}/quantlib-install/lib"</span><span class="p">)</span>

<span class="nb">target_include_directories</span><span class="p">(</span>main PRIVATE <span class="si">${</span><span class="nv">QUANTLIB_INCLUDE_DIR</span><span class="si">}</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span>main PRIVATE <span class="si">${</span><span class="nv">QUANTLIB_LIB_DIR</span><span class="si">}</span>/libQuantLib.so<span class="p">)</span>
</code></pre></div></div>

<p>Four lines play a relevant role for compilation using QuantLib. That I‚Äôll describe below.</p>

<h3 id="setting-the-target">Setting the target</h3>

<p>At least in the initial design, we‚Äôll create an executable file based on codes within a file named <code class="language-plaintext highlighter-rouge">main.cpp</code>, that I‚Äôll describe in next section. But at the moment we are calling this executable as <code class="language-plaintext highlighter-rouge">main</code>, and can be identified in the line below.</p>

<div class="language-cmake highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">add_executable</span><span class="p">(</span>main main.cpp<span class="p">)</span>
</code></pre></div></div>

<h3 id="setting-variables-in-cmake-context">Setting variables in CMake context</h3>
<p>The following lines create two variables in CMake context. They are <code class="language-plaintext highlighter-rouge">QUANTLIB_INCLUDE_DIR</code> and <code class="language-plaintext highlighter-rouge">QUANTLIB_LIB_DIR</code>. The relevante is its connection with the folders where we have installed QuantLib. You will notice the reason why I have described the result of installing the library in foregoing steps. The reason is that the two variables are going to point out to the folders containing QuantLib‚Äôs headers and shared library, respectively.</p>

<div class="language-cmake highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">set</span><span class="p">(</span>QUANTLIB_INCLUDE_DIR <span class="s2">"$ENV{HOME}/quantlib-install/include"</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>QUANTLIB_LIB_DIR <span class="s2">"$ENV{HOME}/quantlib-install/lib"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="linkin-cmake-variables-to-executable">Linkin CMake variables to executable</h3>
<p>As the executable needs to know where to look for any external source of code during preprocessing, compiling and/or linking process, the CMake variables are associated to the executable object in CMake file. Where CMake function <code class="language-plaintext highlighter-rouge">target_include_directories</code> is used to attach the folder containing headers (that‚Äôs why the <strong>include</strong> folder), whereas <code class="language-plaintext highlighter-rouge">target_link_libraries</code> function links the library by means its shared library object (<code class="language-plaintext highlighter-rouge">libQuantLib.so</code>).</p>

<p>Now, let‚Äôs jumpt to the real code.</p>

<h2 id="c-testing-file">C++ testing file</h2>
<p>All this code you can store in a file named <code class="language-plaintext highlighter-rouge">main.cpp</code>, at same level of CMake file. People with experience in C++ may recognize the preprocessor directive <code class="language-plaintext highlighter-rouge">#include</code>, that enables the code to make use of structures coded in other C++ files. In this case I‚Äôm using the headers from quantlib as follows.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ql/instruments/bond.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ql/instruments/bonds/fixedratebond.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ql/time/calendar.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ql/time/calendars/target.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ql/settings.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ql/cashflows/coupon.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ql/time/schedule.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ql/cashflows/fixedratecoupon.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ql/time/daycounters/actualactual.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ql/termstructures/yieldtermstructure.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ql/termstructures/yield/flatforward.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ql/pricingengines/bond/discountingbondengine.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;memory&gt;</span><span class="cp">
</span></code></pre></div></div>

<p>The next lines may be exposed to debate, since some people likes, or argue against, <a href="https://learn.microsoft.com/en-us/cpp/cpp/namespaces-cpp?view=msvc-170" target="_blank" rel="noopener">namespaces</a>. They are a mechanism to add ‚Äúsurnames‚Äù to the structures in C++.  Some people attempt to avoid them for the sake of clarity, but this time since the code is quite small, I‚Äôll skip explicit reference by using namespaces.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">QuantLib</span><span class="p">;</span>
</code></pre></div></div>

<p>Then a main function (Recall this is a straightforward test, and no formal), is created such that I can price a Bond -invented-, that was issued at 19th June 2022, with maturity date 19th March 2029. It pays a quarterly coupon calculated at ACT/365 day counting method. The coupon is 5.7% of notional. Bond‚Äôs notional is $10.000. The only exotic parameter here is the Forward flat rate of 5% used to create the discounting curve for getting the NPV of bond‚Äôs cashflows. The result is the dirty and clean price.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">Date</span> <span class="n">todaysDate</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">August</span><span class="p">,</span> <span class="mi">2025</span><span class="p">);</span>
    <span class="n">Date</span> <span class="n">issueDate</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="n">June</span><span class="p">,</span> <span class="mi">2022</span><span class="p">);</span>
    <span class="n">Date</span> <span class="n">maturityDate</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="n">March</span><span class="p">,</span> <span class="mi">2029</span><span class="p">);</span>
    <span class="n">Calendar</span> <span class="n">calendar</span> <span class="o">=</span> <span class="n">TARGET</span><span class="p">();</span>
    <span class="n">Real</span> <span class="n">notional</span> <span class="o">=</span> <span class="mf">10000.0</span><span class="p">;</span>
    
    <span class="n">todaysDate</span> <span class="o">=</span> <span class="n">calendar</span><span class="p">.</span><span class="n">adjust</span><span class="p">(</span><span class="n">todaysDate</span><span class="p">);</span>

    <span class="n">Frequency</span> <span class="n">frequency</span> <span class="o">=</span> <span class="n">Quarterly</span><span class="p">;</span>
    <span class="n">Rate</span> <span class="n">couponRate</span> <span class="o">=</span> <span class="mf">0.057</span><span class="p">;</span>
    <span class="n">DayCounter</span> <span class="n">dayCounter</span> <span class="o">=</span> <span class="n">ActualActual</span><span class="p">(</span><span class="n">ActualActual</span><span class="o">::</span><span class="n">Actual365</span><span class="p">);</span>

    <span class="cm">/*
    ----------------------------------------------------------------------
    BOND Coupon's calculation
    ----------------------------------------------------------------------
    */</span>
    <span class="n">Schedule</span> <span class="n">schedule</span><span class="p">(</span><span class="n">issueDate</span><span class="p">,</span> <span class="n">maturityDate</span><span class="p">,</span> <span class="n">Period</span><span class="p">(</span><span class="n">frequency</span><span class="p">),</span>
                    <span class="n">TARGET</span><span class="p">(),</span> <span class="n">Following</span><span class="p">,</span> <span class="n">Following</span><span class="p">,</span>
                    <span class="n">DateGeneration</span><span class="o">::</span><span class="n">Backward</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>

    <span class="c1">// Build Leg using FixedRateLeg</span>
    <span class="n">Leg</span> <span class="n">coupons</span> <span class="o">=</span> <span class="n">FixedRateLeg</span><span class="p">(</span><span class="n">schedule</span><span class="p">)</span>
                    <span class="p">.</span><span class="n">withNotionals</span><span class="p">(</span><span class="n">notional</span><span class="p">)</span>
                    <span class="p">.</span><span class="n">withCouponRates</span><span class="p">(</span><span class="n">couponRate</span><span class="p">,</span> <span class="n">dayCounter</span><span class="p">);</span>

    <span class="c1">// Print coupon payment dates and amounts</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">cf</span> <span class="o">:</span> <span class="n">coupons</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Payment date: "</span> <span class="o">&lt;&lt;</span> <span class="n">cf</span><span class="o">-&gt;</span><span class="n">date</span><span class="p">()</span>
                <span class="o">&lt;&lt;</span> <span class="s">", Amount: "</span> <span class="o">&lt;&lt;</span> <span class="n">cf</span><span class="o">-&gt;</span><span class="n">amount</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cm">/*
    ----------------------------------------------------------------------
    BOND Pricing
    ----------------------------------------------------------------------
    */</span>
    <span class="n">Settings</span><span class="o">::</span><span class="n">instance</span><span class="p">().</span><span class="n">evaluationDate</span><span class="p">()</span> <span class="o">=</span> <span class="n">todaysDate</span><span class="p">;</span>

    <span class="c1">// Discounting curve using a Flat Forward rate</span>
    <span class="n">Handle</span><span class="o">&lt;</span><span class="n">YieldTermStructure</span><span class="o">&gt;</span> <span class="n">discountCurve</span><span class="p">(</span>
        <span class="n">boost</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">FlatForward</span><span class="o">&gt;</span><span class="p">(</span><span class="n">todaysDate</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">ActualActual</span><span class="p">(</span><span class="n">ActualActual</span><span class="o">::</span><span class="n">Actual365</span><span class="p">),</span> <span class="n">Compounded</span><span class="p">)</span>
    <span class="p">);</span>

    <span class="c1">// Bond instance creation</span>
    <span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Bond</span><span class="o">&gt;</span> <span class="n">bond</span> <span class="o">=</span> <span class="n">boost</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">FixedRateBond</span><span class="o">&gt;</span><span class="p">(</span>
        <span class="mi">0</span><span class="p">,</span> <span class="c1">// settlement days</span>
        <span class="n">notional</span><span class="p">,</span>
        <span class="n">schedule</span><span class="p">,</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Rate</span><span class="o">&gt;</span><span class="p">{</span><span class="n">couponRate</span><span class="p">},</span>
        <span class="n">dayCounter</span><span class="p">,</span>
        <span class="n">Following</span><span class="p">,</span>
        <span class="n">notional</span><span class="p">,</span>
        <span class="n">issueDate</span>
    <span class="p">);</span>

    <span class="c1">// Setting Bond Pricer, that allows to us pricing the bond by linking the Discount curve</span>
    <span class="n">bond</span><span class="o">-&gt;</span><span class="n">setPricingEngine</span><span class="p">(</span>
        <span class="n">boost</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">DiscountingBondEngine</span><span class="o">&gt;</span><span class="p">(</span><span class="n">discountCurve</span><span class="p">)</span>
    <span class="p">);</span>

    <span class="c1">// Calculation of clean and dirty prices</span>
    <span class="n">Real</span> <span class="n">cleanPrice</span> <span class="o">=</span> <span class="n">bond</span><span class="o">-&gt;</span><span class="n">cleanPrice</span><span class="p">();</span>
    <span class="n">Real</span> <span class="n">dirtyPrice</span> <span class="o">=</span> <span class="n">bond</span><span class="o">-&gt;</span><span class="n">dirtyPrice</span><span class="p">();</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Clean Price: "</span> <span class="o">&lt;&lt;</span> <span class="n">cleanPrice</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Dirty Price: "</span> <span class="o">&lt;&lt;</span> <span class="n">dirtyPrice</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="compiling-the-test">Compiling the test</h2>
<p>Resulting structure of files above should be like</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>quantlib_test_installing/
‚îú‚îÄ‚îÄ build/
‚îú‚îÄ‚îÄ‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ‚îÄ‚îÄ main
‚îú‚îÄ‚îÄ CMakeLists.txt
‚îî‚îÄ‚îÄ main.cpp
</code></pre></div></div>

<p>Consequently, to test out code, in this ocassion we need to follow similar steps as when we compiled QuantLib codes. Those are:</p>
<ul>
  <li>Creating a <code class="language-plaintext highlighter-rouge">\build</code> folder</li>
  <li>Executing <code class="language-plaintext highlighter-rouge">cmake ..</code> command, within <code class="language-plaintext highlighter-rouge">\build</code> folder</li>
  <li>Execute <code class="language-plaintext highlighter-rouge">make</code> command, within <code class="language-plaintext highlighter-rouge">\build</code> folder</li>
</ul>

<p>Now!, you‚Äôll see a new file within <code class="language-plaintext highlighter-rouge">\build</code> folder named <code class="language-plaintext highlighter-rouge">main</code>. Recall this is the name we setup in <code class="language-plaintext highlighter-rouge">CMakeList.txt</code> file, more explicitely when using the function <code class="language-plaintext highlighter-rouge">add_executable</code>. You can change the name in that line to whatever you want, and the output once you run <code class="language-plaintext highlighter-rouge">make</code> is the file with that name. Then to run the executable just type in the terminal following command.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>./main
</code></pre></div></div>

<p><strong>Voila!!</strong>. You wil have installed correctly QuantLib, and tested it via a straghtforward example, pricing a bond.</p>

<p><img src="/assets/images/01_post_images/004_quant_developer/002_make_quantlib_test.png" alt="Calling MCP Server" /></p>

<h2 id="i-want-to-run-with-commands">I Want to run with commands!</h2>
<p>In case you prefer more command line for compiling code instead of tools such as CMake, the test can be compiled using the command below.</p>

<p>First you need to add QuantLib‚Äôs path to environment variable <code class="language-plaintext highlighter-rouge">LD_LIBRARY_PATH</code>, such that allows the dynamic linker where to look for files.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span><span class="nb">export </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span>/home/donnetoo/quantlib-install/lib:<span class="nv">$LD_LIBRARY_PATH</span>
</code></pre></div></div>

<p>Then, once the linker knows where to look for the library codes, you may compile <code class="language-plaintext highlighter-rouge">main.cpp</code> file to produce an executable named <code class="language-plaintext highlighter-rouge">main</code>, as done in CMake scheme, using <code class="language-plaintext highlighter-rouge">g++</code> compiler, as follows.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>g++ <span class="nt">-std</span><span class="o">=</span>c++17 <span class="nt">-I</span><span class="nv">$HOME</span>/quantlib-install/include main.cpp <span class="nt">-L</span><span class="nv">$HOME</span>/quantlib-install/lib <span class="nt">-lQuantLib</span> <span class="nt">-o</span> main
</code></pre></div></div>

<p>Conversely to CMake, here you can run the command even at same level of <code class="language-plaintext highlighter-rouge">main.cpp</code>. Just take into account the executable named <code class="language-plaintext highlighter-rouge">main</code> will be created at same level, unless you specify either a relative or an absolute path where to create it.</p>

<hr />

<p>Hope this information is useful for you. Any doubt not hesitate reaching me out via LinkedIn, I‚Äôll be really happy to help.</p>
</p>
        
			
		
			
        
			
		
			
        
			
		
			
        
			
		
			
        
			
		
			
        
			
		
			
        
			
		
			
        
			
		
	</div>
      </section>

    </div>

    <!-- Contact -->
<section id="contact">
	<div class="inner">
		<section>
			<form action="https://formspree.io/craquinterogo@gmail.com" method="POST">
				<div class="field half first">
					<label for="name">Name</label>
					<input type="text" name="name" id="name" />
				</div>
				<div class="field half">
					<label for="email">Email</label>
					<input type="text" name="_replyto" id="email" />
				</div>
				<div class="field">
					<label for="message">Message</label>
					<textarea name="message" id="message" rows="6"></textarea>
				</div>
				<ul class="actions">
					<li><input type="submit" value="Send Message" class="special" /></li>
					<li><input type="reset" value="Clear" /></li>
				</ul>
			</form>
		</section>
		<section class="split">
			<section>
				<div class="contact-method">
					<span class="icon alt fa-envelope"></span>
					<h3>Email</h3>
					<a href="#">craquinterogo@gmail.com</a>
				</div>
			</section>
			<section>
				<div class="contact-method">
					<span class="icon alt fa-phone"></span>
					<h3>Phone</h3>
					<span>(+48) 539 641 920</span>
				</div>
			</section>
			<section>
				<div class="contact-method">
					<span class="icon alt fa-home"></span>
					<h3>Address</h3>
					<span>
					
					    Warsaw<br />
					
					
					    Warsaw,
					
					
					    WAR 
					
					
					
					    Poland
					
					</span>
				</div>
			</section>
		</section>
	</div>
</section>

<!-- Footer -->
	<footer id="footer">
		<div class="inner">
			<ul class="icons">
				
				<li><a href="https://twitter.com/_arleyquintero" class="icon alt fa-twitter" target="_blank"><span class="label">Twitter</span></a></li>
				
				
				
				
				
				
				
				
				<li><a href="https://github.com/craquinterogo/quantitative_finance" class="icon alt fa-github" target="_blank"><span class="label">GitHub</span></a></li>
				
				
				
				<li><a href="https://www.linkedin.com/in/craquinterogo/?locale=en_US" class="icon alt fa-linkedin" target="_blank"><span class="label">LinkedIn</span></a></li>
				
			</ul>
			<ul class="copyright">
				<li>&copy; Cristian Quintero</li>
				<li>Design: <a href="https://html5up.net" target="_blank">HTML5 UP</a></li>
				<li>Jekyll integration: <a href="http://andrewbanchi.ch" target="_blank">Andrew Banchich</a></li>

			</ul>
		</div>
	</footer>

</div>

<!-- Scripts -->
	<script src="/assets/js/jquery.min.js"></script>
	<script src="/assets/js/jquery.scrolly.min.js"></script>
	<script src="/assets/js/jquery.scrollex.min.js"></script>
	<script src="/assets/js/skel.min.js"></script>
	<script src="/assets/js/util.js"></script>
	<!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js"></script><![endif]-->
	<script src="/assets/js/main.js"></script>


        <script>
      // Sidebar toggle functionality
      document.addEventListener('DOMContentLoaded', function() {
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebar-toggle');
        const sidebarOverlay = document.getElementById('sidebar-overlay');
        const tocSidebar = document.getElementById('toc-sidebar');
        const tocToggle = document.getElementById('toc-toggle');
        
        if (sidebarToggle && sidebar && sidebarOverlay) {
          sidebarToggle.addEventListener('click', function() {
            sidebar.classList.toggle('active');
            sidebarOverlay.classList.toggle('active');
          });
          
          sidebarOverlay.addEventListener('click', function() {
            sidebar.classList.remove('active');
            sidebarOverlay.classList.remove('active');
          });
        }
        // TOC toggle button logic
        if (tocToggle && tocSidebar) {
          // Always hide TOC sidebar on load
          tocSidebar.classList.add('toc-hidden');
          tocToggle.addEventListener('click', function() {
            tocSidebar.classList.toggle('toc-hidden');
            tocSidebar.classList.toggle('active');
          });
        }
        // --- Table of Contents Sidebar Generation with Numbering (include all headings in TOC and content) ---
        const mainContent = document.querySelector('#main .inner');
        if (tocSidebar && mainContent) {
          const headings = mainContent.querySelectorAll('h1, h2, h3, h4');
          if (headings.length > 2) {
            let tocHtml = '<div class="toc-title">Table of Contents</div><ul class="toc-list">';
            let numbers = [0, 0, 0, 0]; // For h1-h4
            let tocNumbers = [0, 0, 0, 0]; // Separate numbering for TOC
            // Start from the first heading (index 0)
            for (let idx = 0; idx < headings.length; idx++) {
              const heading = headings[idx];
              const level = parseInt(heading.tagName.substring(1)) - 1; // 0-based
              // Update numbering for content
              numbers[level]++;
              for (let i = level + 1; i < numbers.length; i++) numbers[i] = 0;
              // Build number string for content
              let numberStr = numbers.slice(0, level + 1).filter(n => n > 0).join('.');
              // Prepend number to heading text
              let headingText = heading.textContent.replace(/^\d+(\.\d+)*\.\s*/, '');
              heading.innerHTML = `<span class=\"section-number\">${numberStr}.</span> ` + headingText;
              if (!heading.id) {
                heading.id = headingText.trim().toLowerCase().replace(/[^a-z0-9]+/g, '-');
              }
              // Add all headings to TOC
              tocNumbers[level]++;
              for (let i = level + 1; i < tocNumbers.length; i++) tocNumbers[i] = 0;
              let tocNumberStr = tocNumbers.slice(0, level + 1).filter(n => n > 0).join('.');
              tocHtml += `<li class=\"toc-level-${level+1}\"><a href=\"#${heading.id}\"><span class='section-number'>${tocNumberStr}.</span> ${headingText}</a></li>`;
            }
            tocHtml += '</ul>';
            tocSidebar.innerHTML = tocHtml;
            // Do NOT add .active or remove .toc-hidden here
          } else {
            tocSidebar.classList.add('toc-hidden'); // Hide if not enough headings
          }
        }
      });
    </script>

  </body>

</html>
  </body>

</html>
