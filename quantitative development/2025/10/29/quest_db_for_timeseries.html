<!DOCTYPE html>
<!--
    Forty by HTML5 UP
    html5up.net | @ajlkn
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
  -->
<html>

  <head>
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-6YNFJY0416"></script>
	<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'G-6YNFJY0416');
	</script>
	<title>QuestDB, an alternative for Timeseries Databases. | Cristian</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js"></script><![endif]-->
	<link rel="stylesheet" href="/assets/css/main.css" />
	<!--[if lte IE 9]><link rel="stylesheet" href="/assets/css/ie9.css" /><![endif]-->
	<!--[if lte IE 8]><link rel="stylesheet" href="/assets/css/ie8.css" /><![endif]-->
	<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicon_io/facapple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon_io/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon_io/favicon-16x16.png">
	<link rel="manifest" href="/assets/images/favicon_io/site.webmanifest">
		<!-- KaTeX Configuration -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
	<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
	<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
		onload="renderMathInElement(document.body, {
			delimiters: [
				{left: '$$', right: '$$', display: true},
				{left: '$', right: '$', display: false},
				{left: '\\(', right: '\\)', display: false},
				{left: '\\[', right: '\\]', display: true}
			]
		});"></script>
</head>


  <body class="layout-post">

    <!-- Wrapper -->
<div id="wrapper">

<!-- Header -->
<header id="header">
	<a href="/" class="logo"><strong>Cristian</strong> <span>Quintero</span></a>
	<nav>
		<a href="#menu">Menu</a>
	</nav>
</header>

<!-- Menu -->
<nav id="menu">
	<ul class="links">
        
		    
		
		    
		
		    
		
		    
		        <li><a href="/">Home</a></li>
	    	
		
		    
		
		    
		
		    
		
		
		    
		
		    
		        <li><a href="/about_me.html">About Me</a></li>
		    
		
		    
		        <li><a href="/all_posts.html">All posts</a></li>
		    
		
		    
		
		    
		        <li><a href="/my_posts.html">My posts</a></li>
		    
		
		    
		        <li><a href="/whatilike.html">I like</a></li>
		    
		
	</ul>
	<ul class="actions vertical">
		<li><a href="#" class="button special fit">Get Started</a></li>
		<li><a href="#" class="button fit">Log In</a></li>
	</ul>
</nav>
 
    
    <!-- Enhanced Sidebar with Category-specific Posts -->
    
      
        
          
          
          
    
    <aside id="sidebar" class="sidebar">
      <div class="sidebar-content">
        
          <div class="sidebar-category-header">
            <h3>Quantitative Development</h3>
            <div class="category-indicator"></div>
          </div>
          <h4>Posts in this Category</h4>
          <ul class="recent-posts">
            
            
            
              <li class="recent-post-item">
                <a href="/quantitative%20development/2025/08/10/quantlib_setup.html" class="recent-post-link">
                  
                    <div class="recent-post-image">
                      <img src="/assets/images/01_post_images/004_quant_developer/00_circuit.jpg" alt="Setting QuantLib up in my laptop, again. An amazing tool for quants." />
                    </div>
                  
                  <div class="recent-post-content">
                    <h5>Setting QuantLib up in my laptop, aga...</h5>
                    
                      <span class="recent-post-date">Aug 10, 2025</span>
                    
                  </div>
                </a>
              </li>
            
              <li class="recent-post-item">
                <a href="/quantitative%20development/2025/06/29/ai_agent_for_quants.html" class="recent-post-link">
                  
                    <div class="recent-post-image">
                      <img src="/assets/images/04_llm_and_mcp/jarvis_.jpg" alt="What about AI Agents for Quants?" />
                    </div>
                  
                  <div class="recent-post-content">
                    <h5>What about AI Agents for Quants?</h5>
                    
                      <span class="recent-post-date">Jun 29, 2025</span>
                    
                  </div>
                </a>
              </li>
            
            
          </ul>
          
          <!-- Show link to all posts in this category -->
          <div class="sidebar-category-link">
            <a href="/my_posts.html" class="view-all-category">
              View All Quantitative Development Posts ‚Üí
            </a>
          </div>
        
      </div>
    </aside>

    <!-- Sidebar toggle for mobile -->
    <button id="sidebar-toggle" class="sidebar-toggle" aria-label="Toggle sidebar">
      <i class="fa fa-bars"></i>
    </button>
    
    <!-- Sidebar overlay for mobile -->
    <div id="sidebar-overlay" class="sidebar-overlay"></div>
    
    <!-- Table of Contents Sidebar -->
    <button id="toc-toggle" class="toc-toggle" title="Show/Hide Table of Contents" aria-label="Show/Hide Table of Contents">
      <span aria-hidden="true">üìë</span>
    </button>
    <nav id="toc-sidebar" class="toc-sidebar"></nav>

    <!-- Main -->
    <div id="main" class="alt">

      <!-- One -->
      <section id="one">
	<div class="inner">
		
			
        
          <header class="major">
            <h1>QuestDB, an alternative for Timeseries Databases.</h1>
          </header>
          
            <div class="post-image-container">
              <img src="/assets/images/01_post_images/004_quant_developer/01_financial-data-visualization.jpg" alt="QuestDB, an alternative for Timeseries Databases." />
            </div>
          
          <p>Oct 29, 2025</p>
          <p><p>Over the past two weeks, I‚Äôve enjoyed some much-needed rest and time to reflect on my personal projects. One ongoing challenge has been efficiently storing financial time series data for future analysis. Selecting the right storage format is crucial‚Äîespecially when seeking open-source database engines as alternatives to the widely used and robust <a href="https://kx.com/products/kdb/" target="_blank" rel="noopener">KDB+</a>. I‚Äôve had the opportunity to work with KDB+ and its intuitive <strong>q</strong> programming language, which is both powerful and user-friendly. However, as your projects grow and require greater scalability, you‚Äôll quickly realize that KDB+ comes with licensing costs. While these costs are justifiable for medium to large-scale initiatives, they may not be ideal for personal or smaller-scale projects where you want to start lean and scale gradually. Even <strong>KX</strong> acknowledges this in their own blog, offering a brief comparison between KDB+ and QuestDB‚Äîsee their analysis <a href="https://kx.com/compare/kx-vs-questdb/" target="_blank" rel="noopener">here</a>. For those looking to balance capability with cost, exploring open-source alternatives becomes essential.</p>

<p>In my projects, I routinely manage large volumes of time series data at various granularities‚Äîseconds, minutes, and days. While some may suggest aggregating these series in memory for time scaling, this approach introduces significant computational overhead. To address this, I maintain parallel copies of different frequencies, always seeking a robust database engine capable of handling such workloads efficiently. After extensive testing over several weekends, I discovered a solution that has consistently met my requirements: <a href="https://questdb.com/" target="_blank" rel="noopener">QuestDB</a>.</p>

<p>QuestDB is an <strong>open-source</strong> time-series database designed for high-performance storage and retrieval of time series data. Its intuitive user interface eliminates the steep learning curve often associated with specialized time-series solutions. While there are other options available, my experience with QuestDB has been particularly positive. For context, I currently manage approximately 80 time series, each updated at second-level frequency from 08:30 to 18:00 daily, over a period of three months. Even when executing broad queries such as <code class="language-plaintext highlighter-rouge">SELECT *</code>, QuestDB has delivered reliable performance without issue. Importantly, it leverages standard SQL for data retrieval, making it accessible and straightforward for users familiar with relational databases.</p>

<blockquote>
  <p>‚ö†Ô∏è <strong>Warning</strong> :: I got inspired to share this information in case may be useful to somebody else. <strong>This post is not intended to benchmark QuestDB</strong>, but explaining how to install it, and even better, how to store your financial timeseries data in an external pen drive, it‚Äôs pretty easy, you shall see. A plus added is a small backtesting conducted using the data ingested in QuestDB.</p>
</blockquote>

<h1 id="installation">Installation</h1>
<p>The instalation is nothing different to what‚Äôs explained in their <a href="https://questdb.com/download/" target="_blank" rel="noopener">webpage</a>, so I‚Äôm not going to dive deep on that, that by the way is pretty nice explained and explicit for each operative system. In my case it is Linux. Instead, I want to emphasizessssssss on how it works once you want to create a basic database for storing, i.e. crypto currency price timeseries. Once downloaded, you can run the following commands.</p>

<ul>
  <li>Unzip the tar.gz file, that will create a new folder. Please notice the version of this example is QuestDB 9.1.0, therefore, if more recent version is released, you need to change the version once unzipped. The unzipped folder is namedd <code class="language-plaintext highlighter-rouge">questdb-9.1.0-rt-linux-x86-64</code> in this example.
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span><span class="nb">tar</span> <span class="nt">-xvzf</span> questdb.tar.gz
</code></pre></div>    </div>
  </li>
  <li>Moving the unzipped folder to the folder of your preference. In my case, it is <code class="language-plaintext highlighter-rouge">opt/questdb</code>, taking into consideration the linux directory functionality, as explained <a href="https://www.geeksforgeeks.org/linux-unix/linux-directory-structure/" target="_blank" rel="noopener">here</a>.
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span><span class="nb">mv </span>questdb-9.1.0-rt-linux-x86-64 opt/questdb
</code></pre></div>    </div>
  </li>
  <li>Once the folder is moved to <code class="language-plaintext highlighter-rouge">opt/questdb</code>, you will notice there is a file named <code class="language-plaintext highlighter-rouge">bin/questdb.sh</code> within. This shell file is in charge of starting or stopping the database engine daemon. So my suggestion is to avoid referring always to the absolute path, just adding an alias in your <code class="language-plaintext highlighter-rouge">.bashrc</code> file (more info <a href="https://wiki.manjaro.org/index.php/Aliases_in_.bashrc" target="_blank" rel="noopener">here</a>). For instance as follows.</li>
</ul>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">alias questdb_engine='/opt/questdb/questdb-9.1.0-rt-linux-x86-64/bin/questdb.sh'
</span></code></pre></div></div>
<h2 id="questdb-database-creation">QuestDB database creation</h2>
<p>Now, the goal is to store the data in a pen drive, such that is also available in any other machine with QuestDB installed. The reader may be thinking ‚Äúwhy do not even allow QuestDB being portable‚Äù?. I though about this option, but in this use case the data is the king, and QuestDB the King‚Äôs sword. So, let‚Äôs create it assuming you have a pen drive that is accessible in the path <code class="language-plaintext highlighter-rouge">/media/&lt;username&gt;/&lt;pendrive-name&gt;</code>, once mounted in linux. Internally, you have created a new folder named <code class="language-plaintext highlighter-rouge">my-timeseries/</code>, therefore, the complete path is <code class="language-plaintext highlighter-rouge">/media/&lt;username&gt;/&lt;pendrive-name&gt;/my-timeseries/</code>. Let‚Äôs create the database in there.</p>

<p>The alias <code class="language-plaintext highlighter-rouge">questdb_engine</code> was created above. Thereby, you will be able to run the engine storing metadata and data in the pendrive by runnning the following command.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>questdb_engine start <span class="nt">-d</span> /media/&lt;username&gt;/&lt;pendrive-name&gt;/my-timeseries/
</code></pre></div></div>

<p><strong>Voila!</strong>, if you see an output like shown below, you have created your database in an external drive!!. I told you is pretty easy!, but that‚Äôs not all I want to share with you. As you can see in the prompt below, you have a user interface via webbrowser to interact with your data!, yous click in the url <code class="language-plaintext highlighter-rouge">http://172.17.0.1:9000</code> or type it in your broser. Immedialy you will get into the nice user interface, which is also quite intuitive if you already have experience with SQL IDEs, but if you want more info take a look in this <a href="https://www.youtube.com/watch?v=oIHTjT_SzVI" target="_blank" rel="noopener">video in Youtube</a>, and subscribe to the channel.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">JAVA: /opt/questdb/questdb-9.1.0-rt-linux-x86-64/bin/java

     ___                  _   ____  ____
    / _ \ _   _  ___  ___| |_|  _ \| __ )
   | | | | | | |/ _ \/ __| __| | | |  _ \
   | |_| | |_| |  __/\__ \ |_| |_| | |_) |
    \__\_\\__,_|\___||___/\__|____/|____/
                        www.questdb.io

    Web Console URL                 ILP Client Connection String

</span><span class="gp">    http://172.17.0.1:9000          http::addr=172.17.0.1:9000;</span><span class="w">
</span><span class="gp">    http://192.168.1.14:9000        http::addr=192.168.1.14:9000;</span><span class="w">
</span><span class="gp">    http://127.0.0.1:9000           http::addr=127.0.0.1:9000;</span><span class="w">
</span><span class="go">
</span><span class="gp">QuestDB configuration files are in /media/&lt;username&gt;</span>/&lt;pendrive-name&gt;/my-timeseries/conf
<span class="go">
</span></code></pre></div></div>

<h1 id="experiment">Experiment</h1>
<p>Now, the UI looks nice, but what to do with all that in your pocket?. Let‚Äôs assume that you have the following timeseries in a csv file, and you would like to store it in your just created QuestDB database.</p>

<table>
  <thead>
    <tr>
      <th>date</th>
      <th>close</th>
      <th>volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>20250313 15:30:00 Europe/Warsaw</td>
      <td>121.73</td>
      <td>123702.34</td>
    </tr>
    <tr>
      <td>20250313 15:30:01 Europe/Warsaw</td>
      <td>122.15</td>
      <td>124100.12</td>
    </tr>
    <tr>
      <td>20250313 15:30:02 Europe/Warsaw</td>
      <td>121.98</td>
      <td>123950.87</td>
    </tr>
    <tr>
      <td>20250313 15:30:03 Europe/Warsaw</td>
      <td>122.30</td>
      <td>124210.45</td>
    </tr>
    <tr>
      <td>20250313 15:30:04 Europe/Warsaw</td>
      <td>121.65</td>
      <td>123800.56</td>
    </tr>
    <tr>
      <td>20250313 15:30:05 Europe/Warsaw</td>
      <td>122.05</td>
      <td>124050.23</td>
    </tr>
    <tr>
      <td>20250313 15:30:06 Europe/Warsaw</td>
      <td>121.90</td>
      <td>123900.77</td>
    </tr>
    <tr>
      <td>20250313 15:30:07 Europe/Warsaw</td>
      <td>122.20</td>
      <td>124180.34</td>
    </tr>
    <tr>
      <td>20250313 15:30:08 Europe/Warsaw</td>
      <td>121.80</td>
      <td>123850.12</td>
    </tr>
    <tr>
      <td>20250313 15:30:09 Europe/Warsaw</td>
      <td>122.10</td>
      <td>124120.65</td>
    </tr>
  </tbody>
</table>

<h2 id="creation-of-your-first-table">Creation of your first table</h2>
<p>As in many databases, you store data in tabular format by means tables. Those tables are created ad-hoc, as you wish or require. In this case, for abovementioned data, we can create the table executing the following command in QuestDB user interface (web-browser).</p>

<pre><code class="language-SQL">CREATE TABLE 'prices' (
  date TIMESTAMP,
  close FLOAT,
  volume FLOAT,
) timestamp (date) PARTITION BY DAY BYPASS WAL;
</code></pre>

<p>This table will store the table mentioned as example. Some considerations are:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">timestamp (date)</code>: Specifies that the date column is the designated timestamp for this table. QuestDB uses this to efficiently index and query time-series data.</li>
  <li><code class="language-plaintext highlighter-rouge">PARTITION BY DAY</code>: Tells QuestDB to store data in daily partitions. This improves query performance and makes it easier to manage large time-series datasets.</li>
  <li><code class="language-plaintext highlighter-rouge">BYPASS WAL</code>: Disables the Write-Ahead Log (WAL) for this table. WAL is used for durability and crash recovery. Bypassing it can improve write performance but may risk data loss if the server crashes before data is flushed to disk.</li>
</ul>

<p>Then the forthcoming step is to use this table to store the data we receive from any source, for instance your broker via websockets.</p>

<h2 id="feeding-with-data">Feeding with data</h2>
<p>The reader, you, may use the client provided by QuestDB in many different programming languages like <a href="https://questdb.com/docs/clients/ingest-python/" target="_blank" rel="noopener">Python</a>, <a href="https://questdb.com/docs/clients/ingest-c-and-cpp/" target="_blank" rel="noopener">C++</a>, Rust, Java, and others. However, during my own experiments I realized that for avoiding to use a streaming data pipelines like Kafka, RabbitMQ, Redpanda or any other, I‚Äôm allowed to use the <strong>ILP protocol</strong>. Beforementioned protocol refers to InfluxDB protocol, that facilitates the massive ingestion of data. Conversely to the client which conveyes data via HTTP protocol, limiting the number of records given the limit size of the payload, ILP protocol conveys the data in another way. The InfluxDB protocol conveys the information by organizing the data in plain text rows with some rules. Here is the same data in <a href="https://questdb.com/docs/reference/api/ilp/line-protocol/" target="_blank" rel="noopener">QuestDB ILP (Influx Line Protocol)</a> format, ready for ingestion:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>prices,close=121.73,volume=123702.34 1748413800000000
prices,close=122.15,volume=124100.12 1748413801000000
prices,close=121.98,volume=123950.87 1748413802000000
prices,close=122.30,volume=124210.45 1748413803000000
prices,close=121.65,volume=123800.56 1748413804000000
prices,close=122.05,volume=124050.23 1748413805000000
prices,close=121.90,volume=123900.77 1748413806000000
prices,close=122.20,volume=124180.34 1748413807000000
prices,close=121.80,volume=123850.12 1748413808000000
prices,close=122.10,volume=124120.65 1748413809000000
</code></pre></div></div>

<p>As you see is quite simple creating the information that is conveyed to QuestDB. Further more, it‚Äôs practically a transformation of a csv file. the first field corresponds to the name of the table where it is registered, namely <code class="language-plaintext highlighter-rouge">prices</code>, just created above. Subsequently, fields <code class="language-plaintext highlighter-rouge">close</code> and <code class="language-plaintext highlighter-rouge">volume</code> is referenced. Eventually, the last set of information corresponds to the date, that was stablished to be the partition of the table, but also expressed in microseconds, always. This is one remark that worths to mention, every column set as <code class="language-plaintext highlighter-rouge">timestamp</code> datatype, requires to be send in ILP protocol in microseconds. Thereby, an example of function that cast the datetime string in C++ is shown below.</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;chrono&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="nf">to_nanoseconds_since_epoch</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">datetime</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">format</span> <span class="o">=</span> <span class="s">"%Y-%m-%dT%H:%M:%S"</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">istringstream</span> <span class="n">ss</span><span class="p">(</span><span class="n">datetime</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">tm</span> <span class="n">tm</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="n">ss</span> <span class="o">&gt;&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">get_time</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tm</span><span class="p">,</span> <span class="n">format</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ss</span><span class="p">.</span><span class="n">fail</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">"Failed to parse datetime: "</span> <span class="o">+</span> <span class="n">datetime</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">auto</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">system_clock</span><span class="o">::</span><span class="n">from_time_t</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">mktime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tm</span><span class="p">));</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">nanoseconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tp</span><span class="p">.</span><span class="n">time_since_epoch</span><span class="p">()).</span><span class="n">count</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Furthermore, a function example that sends the string with all the rows constructed, is detailed below.</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;sys/socket.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;netinet/in.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;arpa/inet.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;cpr/cpr.h&gt;</span><span class="cp">
</span><span class="cm">/**
 * @brief Sends ILP data to a specified host and port over a TCP connection.
 *
 * This function is useful for writing the content of CSV files by transmitting
 * the provided ILP data string to a remote server using a TCP socket.
 *
 * @param host The IP address or hostname of the destination server.
 * @param port The port number to connect to on the destination server.
 * @param ilp_data The ILP data string to be sent, typically representing the content of a CSV file.
 */</span>
<span class="kt">void</span> <span class="nf">send_ilp</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">host</span><span class="p">,</span> <span class="kt">int</span> <span class="n">port</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">ilp_data</span><span class="p">)</span> <span class="p">{</span>

    <span class="kt">int</span> <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">sockaddr_in</span> <span class="n">serv_addr</span><span class="p">{};</span>
    <span class="n">serv_addr</span><span class="p">.</span><span class="n">sin_family</span> <span class="o">=</span> <span class="n">AF_INET</span><span class="p">;</span>
    <span class="n">serv_addr</span><span class="p">.</span><span class="n">sin_port</span> <span class="o">=</span> <span class="n">htons</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
    <span class="n">inet_pton</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">host</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="o">&amp;</span><span class="n">serv_addr</span><span class="p">.</span><span class="n">sin_addr</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">connect</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="p">(</span><span class="n">sockaddr</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">serv_addr</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">serv_addr</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">"Connection failed</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">send</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">ilp_data</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">ilp_data</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">close</span><span class="p">(</span><span class="n">sock</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>
<p>With this set of functions you are ready to convey information to QuestDB, and then use it in any research that requires that information.</p>

<h1 id="using-the-information-in-market-research">Using the information in Market Research</h1>
<p>As any quant, this is just a small piece of the infraestructure required to have available information for any research. But let‚Äôs now assuming you want to use this information in a backtesting example, testing Bollinger Bands. Because it‚Äôs prototyping it‚Äôs pretty much easy to switch to python. Thus, the code is now as follows.</p>

<h2 id="libraries-required">Libraries required</h2>
<p>For this small test you require to install the following list of libraries</p>
<ul>
  <li><a href="https://pypi.org/project/psycopg2-binary/" target="_blank" rel="noopener">psycopg2-binary</a></li>
  <li><a href="https://pypi.org/project/polars/" target="_blank" rel="noopener">polars</a></li>
  <li><a href="https://pypi.org/project/vectorbt/" target="_blank" rel="noopener">vectorbt</a></li>
  <li><a href="https://pypi.org/project/TA-Lib/" target="_blank" rel="noopener">Ta-lib</a></li>
</ul>

<p>Perhaps you saw something interesting. We‚Äôre not necessarily using QuestDB client. This is because besides QuestDB client, it is also possible get access to the database via <code class="language-plaintext highlighter-rouge">psycopg2</code> library, used for connection to PostgreSQL databases.</p>

<h2 id="basic-setup">Basic Setup</h2>

<p>The following lines refer to basic setup for this experiment. Quite standard, I‚Äôd say.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">psycopg2</span>
<span class="kn">import</span> <span class="n">polars</span> <span class="k">as</span> <span class="n">pl</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">plotly.graph_objects</span> <span class="k">as</span> <span class="n">go</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">pl</span><span class="p">.</span><span class="n">Config</span><span class="p">.</span><span class="nf">set_tbl_formatting</span><span class="p">(</span><span class="sh">"</span><span class="s">ASCII_MARKDOWN</span><span class="sh">"</span><span class="p">)</span>
<span class="n">pl</span><span class="p">.</span><span class="n">Config</span><span class="p">.</span><span class="n">tbl_float_precision</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Show 6 decimals
</span>
<span class="n">TABLE</span> <span class="o">=</span> <span class="sh">'</span><span class="s">prices</span><span class="sh">'</span>
</code></pre></div></div>

<h2 id="database-connection">Database Connection</h2>
<p>In this example, the connection to QuestDB is established using the <code class="language-plaintext highlighter-rouge">psycopg2</code> library, which communicates with the database on <code class="language-plaintext highlighter-rouge">localhost</code> via the default port <code class="language-plaintext highlighter-rouge">8812</code>. Unless you have configured custom credentials, the default username and password are used. If you are familiar with other database connectors in different programming languages, you will recognize the need to create a cursor to execute queries and manage communication between the client and the database engine.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">conn</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span>
    <span class="n">dbname</span><span class="o">=</span><span class="sh">"</span><span class="s">qdb</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">user</span><span class="o">=</span><span class="sh">"</span><span class="s">admin</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="sh">"</span><span class="s">quest</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="sh">"</span><span class="s">localhost</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="mi">8812</span>
<span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="retrieving-data">Retrieving data</h2>
<p>Now, the cursor is used to send an SQL sentence selecting the data for dates 2025-03-13 and 2025-03-14. But depending the data you have fed, you can change it to whatever period you have. Without getting into details, the condition to filter dates can be changed of course, to select a range of dates, you know what I mean.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lst_records</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sql_select</span> <span class="o">=</span> <span class="sh">"</span><span class="s">SELECT to_str(date,</span><span class="sh">'</span><span class="s">yyyy-MM-ddTHH:mm:ss</span><span class="sh">'</span><span class="s">) as date,  close, volume</span><span class="se">\n</span><span class="sh">"</span> \
                <span class="sa">f</span><span class="sh">"</span><span class="s">FROM </span><span class="si">{</span><span class="n">TABLE</span><span class="si">}</span><span class="s"> </span><span class="se">\n</span><span class="sh">"</span> \
                <span class="sh">"</span><span class="s">and to_str(date,</span><span class="sh">'</span><span class="s">yyyy-MM-dd</span><span class="sh">'</span><span class="s">) in (</span><span class="sh">'</span><span class="s">2025-03-13</span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="s">2025-03-14</span><span class="sh">'</span><span class="s">)</span><span class="se">\n</span><span class="sh">"</span>
<span class="n">cur</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">sql_select</span><span class="p">)</span>
<span class="n">rows</span> <span class="o">=</span> <span class="n">cur</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">()</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
    <span class="n">lst_records</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
</code></pre></div></div>

<p>Then the info is stored in a <code class="language-plaintext highlighter-rouge">polar</code> dataframe for facilitating the manipulation, as follows.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">schema</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">date</span><span class="sh">"</span><span class="p">,</span> <span class="n">pl</span><span class="p">.</span><span class="n">Utf8</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">close</span><span class="sh">"</span><span class="p">,</span> <span class="n">pl</span><span class="p">.</span><span class="n">Float64</span><span class="p">),</span>
    <span class="p">(</span><span class="sh">"</span><span class="s">volume</span><span class="sh">"</span><span class="p">,</span> <span class="n">pl</span><span class="p">.</span><span class="n">Float64</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">df_prices</span> <span class="o">=</span> <span class="n">pl</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">transpose</span><span class="p">(</span><span class="n">lst_records</span><span class="p">),</span> <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">)</span>

<span class="n">df_prices</span> <span class="o">=</span> <span class="n">df_prices</span><span class="p">.</span><span class="nf">with_columns</span><span class="p">([</span>
    <span class="n">pl</span><span class="p">.</span><span class="nf">col</span><span class="p">(</span><span class="sh">"</span><span class="s">date</span><span class="sh">"</span><span class="p">).</span><span class="nb">str</span><span class="p">.</span><span class="nf">strptime</span><span class="p">(</span><span class="n">pl</span><span class="p">.</span><span class="n">Datetime</span><span class="p">,</span> <span class="sh">"</span><span class="s">%Y-%m-%dT%H:%M:%S</span><span class="sh">"</span><span class="p">),</span>
    <span class="n">pl</span><span class="p">.</span><span class="nf">col</span><span class="p">(</span><span class="sh">"</span><span class="s">extraction_date</span><span class="sh">"</span><span class="p">).</span><span class="nb">str</span><span class="p">.</span><span class="nf">strptime</span><span class="p">(</span><span class="n">pl</span><span class="p">.</span><span class="n">Datetime</span><span class="p">,</span> <span class="sh">"</span><span class="s">%Y-%m-%dT%H:%M:%S</span><span class="sh">"</span><span class="p">)</span>
<span class="p">])</span>
</code></pre></div></div>

<h2 id="calculating-bollinger-bands">Calculating Bollinger Bands</h2>
<p>To avoid reinventing the wheel, this example leverages the <a href="https://ta-lib.org/" target="_blank" rel="noopener">Ta-Lib</a> package for calculating technical indicators such as Bollinger Bands. The following code demonstrates how to perform this calculation. For a deeper understanding of the methodology and additional tips on testing combined strategies, refer to <a href="https://books.google.lk/books?id=UIxyWFkFJ4QC&amp;printsec=frontcover&amp;source=gbs_ge_summary_r&amp;cad=0#v=onepage&amp;q&amp;f=false" target="_blank" rel="noopener">Technical Analysis for the Trading Professional by Constance Brown (Ch. 11)</a>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">upper</span><span class="p">,</span> <span class="n">middle</span><span class="p">,</span> <span class="n">lower</span> <span class="o">=</span> <span class="n">talib</span><span class="p">.</span><span class="nc">BBANDS</span><span class="p">(</span><span class="n">df_prices</span><span class="p">[</span><span class="sh">'</span><span class="s">close</span><span class="sh">'</span><span class="p">],</span> <span class="n">matype</span><span class="o">=</span><span class="n">MA_Type</span><span class="p">.</span><span class="n">SMA</span><span class="p">,</span> <span class="n">timeperiod</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">pl</span><span class="p">.</span><span class="n">Config</span><span class="p">.</span><span class="n">tbl_float_precision</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># Show 6 decimals
</span><span class="n">df_prices</span> <span class="o">=</span> <span class="n">df_prices</span><span class="p">.</span><span class="nf">with_columns</span><span class="p">(</span>
    <span class="n">pl</span><span class="p">.</span><span class="nc">Series</span><span class="p">(</span><span class="sh">"</span><span class="s">upper</span><span class="sh">"</span><span class="p">,</span> <span class="n">upper</span><span class="p">),</span>
    <span class="n">pl</span><span class="p">.</span><span class="nc">Series</span><span class="p">(</span><span class="sh">"</span><span class="s">middle</span><span class="sh">"</span><span class="p">,</span><span class="n">middle</span><span class="p">),</span>
    <span class="n">pl</span><span class="p">.</span><span class="nc">Series</span><span class="p">(</span><span class="sh">"</span><span class="s">lower</span><span class="sh">"</span><span class="p">,</span> <span class="n">lower</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div>

<p>To recap, Bollinger Bands consist of a moving average (MA) as the central baseline, with the upper and lower bands defined by the formula $\text{MA} \pm n \cdot \delta$, where $\text{MA}$ stands for Moving Average, $\delta$ represents the standard deviation and $n$ is the number of standard deviations selected for the strategy. In this example, a moving average period of 14 data points is used.</p>

<h2 id="plotting-the-results">Plotting the results</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="p">.</span><span class="nc">Figure</span><span class="p">()</span>

<span class="n">fig</span><span class="p">.</span><span class="nf">add_trace</span><span class="p">(</span><span class="n">go</span><span class="p">.</span><span class="nc">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">df_prices</span><span class="p">[</span><span class="sh">'</span><span class="s">date</span><span class="sh">'</span><span class="p">].</span><span class="nf">to_numpy</span><span class="p">(),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">df_prices</span><span class="p">[</span><span class="sh">'</span><span class="s">close</span><span class="sh">'</span><span class="p">].</span><span class="nf">to_numpy</span><span class="p">(),</span>
    <span class="n">mode</span><span class="o">=</span><span class="sh">'</span><span class="s">lines</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">Close</span><span class="sh">'</span>
<span class="p">))</span>
<span class="n">fig</span><span class="p">.</span><span class="nf">add_trace</span><span class="p">(</span><span class="n">go</span><span class="p">.</span><span class="nc">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">df_prices</span><span class="p">[</span><span class="sh">'</span><span class="s">date</span><span class="sh">'</span><span class="p">].</span><span class="nf">to_numpy</span><span class="p">(),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">upper</span><span class="p">.</span><span class="nf">to_numpy</span><span class="p">(),</span>
    <span class="n">mode</span><span class="o">=</span><span class="sh">'</span><span class="s">lines</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">Upper Band</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">line</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">dash</span><span class="o">=</span><span class="sh">'</span><span class="s">dash</span><span class="sh">'</span><span class="p">)</span>
<span class="p">))</span>
<span class="n">fig</span><span class="p">.</span><span class="nf">add_trace</span><span class="p">(</span><span class="n">go</span><span class="p">.</span><span class="nc">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">df_prices</span><span class="p">[</span><span class="sh">'</span><span class="s">date</span><span class="sh">'</span><span class="p">].</span><span class="nf">to_numpy</span><span class="p">(),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">lower</span><span class="p">.</span><span class="nf">to_numpy</span><span class="p">(),</span>
    <span class="n">mode</span><span class="o">=</span><span class="sh">'</span><span class="s">lines</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">Lower Band</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">line</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">dash</span><span class="o">=</span><span class="sh">'</span><span class="s">dash</span><span class="sh">'</span><span class="p">)</span>
<span class="p">))</span>

<span class="n">fig</span><span class="p">.</span><span class="nf">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">TABLE</span><span class="si">}</span><span class="s"> : BollingerBands </span><span class="sh">'</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="sh">'</span><span class="s">Time</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="sh">'</span><span class="s">Price</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span>
        <span class="n">tickformat</span><span class="o">=</span><span class="sh">'</span><span class="s">%m/%d-%H:%M:%S</span><span class="sh">'</span>
    <span class="p">),</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">1600</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">900</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="backtesting-the-strategy">Backtesting the strategy</h2>

<p>The core strategy involves entering a <strong>long position</strong> when the price crosses above the <strong>upper Bollinger Band</strong>, and entering a <strong>short position</strong> when the price falls below the <strong>lower Bollinger Band</strong>. This approach aims to capitalize on potential price reversals at the extremes of volatility. For implementation, the <a href="https://vectorbt.dev/api/data/base/" target="_blank" rel="noopener">VectorBT</a> library is utilized due to its intuitive interface and flexibility for backtesting various scenarios.</p>

<p>The entry and exit signals are defined as follows:</p>

<ul>
  <li><strong>Long Entry:</strong> When <code class="language-plaintext highlighter-rouge">price &lt; lower_band</code> or $P &lt; \text{MA} - n \cdot \delta$</li>
  <li><strong>Short Entry:</strong> When <code class="language-plaintext highlighter-rouge">price &gt; upper_band</code> or $P &gt; \text{MA} + n \cdot \delta$</li>
</ul>

<p>This logic can be easily expressed and tested using VectorBT, allowing for rapid prototyping and performance evaluation of the strategy.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">l_entries</span> <span class="o">=</span> <span class="n">df_prices</span><span class="p">[</span><span class="sh">'</span><span class="s">close</span><span class="sh">'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">df_prices</span><span class="p">[</span><span class="sh">'</span><span class="s">lower</span><span class="sh">'</span><span class="p">]</span>
<span class="n">l_exit</span> <span class="o">=</span> <span class="n">df_prices</span><span class="p">[</span><span class="sh">'</span><span class="s">close</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">df_prices</span><span class="p">[</span><span class="sh">'</span><span class="s">upper</span><span class="sh">'</span><span class="p">]</span>
</code></pre></div></div>

<p>A small slipage is added as proportion of the last observed price, but before we need to create the noise.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Slipage
</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">prices_size</span> <span class="o">=</span> <span class="n">df_prices</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">slippage</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0015</span><span class="p">,</span> <span class="n">prices_size</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">df_prices</span><span class="p">[</span><span class="sh">'</span><span class="s">date</span><span class="sh">'</span><span class="p">])</span>
</code></pre></div></div>

<p>Then the portfolio backtesting is created adding entry and exit fees also, as proportion of the total order amount (%). Both cases set as 0.1% of the order amount, as follows. Furthermore, it is set a maximum proportion of available cash that can be used for trading if a signal suggests it, set as 30%. The list of trades can be accessed via <code class="language-plaintext highlighter-rouge">portfolio.trades.records</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">portfolio</span> <span class="o">=</span> <span class="n">vbt</span><span class="p">.</span><span class="n">Portfolio</span><span class="p">.</span><span class="nf">from_signals</span><span class="p">(</span>
    <span class="n">df_prices</span><span class="p">[</span><span class="sh">'</span><span class="s">close</span><span class="sh">'</span><span class="p">],</span>
    <span class="n">l_entries</span><span class="p">,</span>
    <span class="n">l_exit</span><span class="p">,</span>
    <span class="n">slippage</span><span class="o">=</span><span class="n">slippage</span><span class="p">,</span>  <span class="c1"># stochastic slippage per bar (% of price at that moment)
</span>    <span class="n">fees</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="c1"># Percentage of trade
</span>    <span class="n">size</span><span class="o">=</span><span class="mf">0.3</span> <span class="c1"># Using the % in this parameter, over available cash
</span><span class="p">)</span>

<span class="n">trades</span> <span class="o">=</span> <span class="n">portfolio</span><span class="p">.</span><span class="n">trades</span><span class="p">.</span><span class="n">records</span>
</code></pre></div></div>

<p>Eventually, you can see the portfolio performance and plots showing the historical performance in the backtesting.</p>

<ul>
  <li>Show the plots
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">portfolio</span><span class="p">.</span><span class="nf">plot</span><span class="p">().</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div>    </div>
  </li>
  <li>Display performance metrics
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stats</span> <span class="o">=</span> <span class="n">portfolio</span><span class="p">.</span><span class="nf">stats</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>Below an example for another date. The result of this example is not promising, but <strong>that‚Äôs the exciting part, to conduct the appropriate tuning</strong> which I‚Äôll talk about in forthcoming posts.</p>

<p><img src="/assets/images/01_post_images/004_quant_developer/003_bakctesting_example.png" alt="Backtesting Example" /></p>

<div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">Start                         2025-10-30 13:30:00
End                           2025-10-30 19:59:50
Period                            0 days 06:30:00
Start Value                                 100.0
End Value                               99.708598
Total Return [%]                        -0.291402
Benchmark Return [%]                    -0.608365
Max Gross Exposure [%]                    3.98698
Total Fees Paid                          0.202055
Max Drawdown [%]                         0.291248
Max Drawdown Duration             0 days 06:27:50
Total Trades                                   26
Total Closed Trades                            25
Total Open Trades                               1
Open Trade PnL                          -0.009346
Win Rate [%]                                  0.0
Best Trade [%]                          -0.069792
Worst Trade [%]                         -0.499154
Avg Winning Trade [%]                         NaN
Avg Losing Trade [%]                    -0.284596
Avg Winning Trade Duration                    NaT
Avg Losing Trade Duration         0 days 00:09:02
Profit Factor                                 0.0
Expectancy                              -0.011282
Sharpe Ratio                          -122.161294
Calmar Ratio                           -336.62527
Omega Ratio                               0.74954
Sortino Ratio                         -155.247853
dtype: object
</span></code></pre></div></div>

<h2 id="closing-the-cursor-and-the-connection">Closing the cursor and the connection</h2>
<p>It is a good practice to finish the connection once it is not used anymore, specially to release resources. It can be done as follows.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cur</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
<span class="n">conn</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</code></pre></div></div>

<h1 id="stoping-questdb">Stoping QuestDB</h1>
<p>As you remember you have created an alias named <code class="language-plaintext highlighter-rouge">questdb_engine</code>. You can use the same to stop the daemon once you don‚Äôt need it anymore, thereby you close any connection. Just remember start the daemon again if you want to use it again.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">&gt;</span><span class="w"> </span>questdb_engine stops
</code></pre></div></div>

<h1 id="key-takeaways">Key Takeaways</h1>

<ul>
  <li><strong>QuestDB offers a compelling, cost-effective alternative to the KDB engine</strong> for time-series data storage and analysis.</li>
  <li><strong>External storage support:</strong> QuestDB can store both data and metadata on external devices by specifying a simple parameter at daemon startup, enhancing portability and flexibility.</li>
  <li><strong>SQL compatibility:</strong> The familiar SQL language makes it easy to get started and interact with the database, especially for those new to QuestDB.</li>
  <li><strong>Optimized for time-series workloads:</strong> While QuestDB is designed for efficient time-series data handling, it does not provide the same breadth of built-in time-series functions as KDB.</li>
  <li><strong>PostgreSQL connector support:</strong> QuestDB can be accessed using standard PostgreSQL connectors, simplifying integration and management across various programming environments.</li>
  <li><strong>Efficient data ingestion:</strong> The Influx Line Protocol (ILP) enables high-performance ingestion of large volumes of time-series data, outperforming traditional HTTP-based methods for bulk operations.</li>
</ul>

<hr />
<p>Hope this information is useful for you. Any doubt not hesitate reaching me out via LinkedIn, I‚Äôll be really happy to help.</p>
</p>
        
			
		
			
        
			
		
			
        
			
		
			
        
			
		
			
        
			
		
			
        
			
		
			
        
			
		
			
        
			
		
			
        
			
		
	</div>
      </section>

    </div>

    <!-- Contact -->
<section id="contact">
	<div class="inner">
		<section>
			<form action="https://formspree.io/craquinterogo@gmail.com" method="POST">
				<div class="field half first">
					<label for="name">Name</label>
					<input type="text" name="name" id="name" />
				</div>
				<div class="field half">
					<label for="email">Email</label>
					<input type="text" name="_replyto" id="email" />
				</div>
				<div class="field">
					<label for="message">Message</label>
					<textarea name="message" id="message" rows="6"></textarea>
				</div>
				<ul class="actions">
					<li><input type="submit" value="Send Message" class="special" /></li>
					<li><input type="reset" value="Clear" /></li>
				</ul>
			</form>
		</section>
		<section class="split">
			<section>
				<div class="contact-method">
					<span class="icon alt fa-envelope"></span>
					<h3>Email</h3>
					<a href="#">craquinterogo@gmail.com</a>
				</div>
			</section>
			<section>
				<div class="contact-method">
					<span class="icon alt fa-phone"></span>
					<h3>Phone</h3>
					<span>(+48) 539 641 920</span>
				</div>
			</section>
			<section>
				<div class="contact-method">
					<span class="icon alt fa-home"></span>
					<h3>Address</h3>
					<span>
					
					    Warsaw<br />
					
					
					    Warsaw,
					
					
					    WAR 
					
					
					
					    Poland
					
					</span>
				</div>
			</section>
		</section>
	</div>
</section>

<!-- Footer -->
	<footer id="footer">
		<div class="inner">
			<ul class="icons">
				
				<li><a href="https://twitter.com/_arleyquintero" class="icon alt fa-twitter" target="_blank"><span class="label">Twitter</span></a></li>
				
				
				
				
				
				
				
				
				<li><a href="https://github.com/craquinterogo/quantitative_finance" class="icon alt fa-github" target="_blank"><span class="label">GitHub</span></a></li>
				
				
				
				<li><a href="https://www.linkedin.com/in/craquinterogo/?locale=en_US" class="icon alt fa-linkedin" target="_blank"><span class="label">LinkedIn</span></a></li>
				
			</ul>
			<ul class="copyright">
				<li>&copy; Cristian Quintero</li>
				<li>Design: <a href="https://html5up.net" target="_blank">HTML5 UP</a></li>
				<li>Jekyll integration: <a href="http://andrewbanchi.ch" target="_blank">Andrew Banchich</a></li>

			</ul>
		</div>
	</footer>

</div>

<!-- Scripts -->
	<script src="/assets/js/jquery.min.js"></script>
	<script src="/assets/js/jquery.scrolly.min.js"></script>
	<script src="/assets/js/jquery.scrollex.min.js"></script>
	<script src="/assets/js/skel.min.js"></script>
	<script src="/assets/js/util.js"></script>
	<!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js"></script><![endif]-->
	<script src="/assets/js/main.js"></script>


        <script>
      // Sidebar toggle functionality
      document.addEventListener('DOMContentLoaded', function() {
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebar-toggle');
        const sidebarOverlay = document.getElementById('sidebar-overlay');
        const tocSidebar = document.getElementById('toc-sidebar');
        const tocToggle = document.getElementById('toc-toggle');
        
        if (sidebarToggle && sidebar && sidebarOverlay) {
          sidebarToggle.addEventListener('click', function() {
            sidebar.classList.toggle('active');
            sidebarOverlay.classList.toggle('active');
          });
          
          sidebarOverlay.addEventListener('click', function() {
            sidebar.classList.remove('active');
            sidebarOverlay.classList.remove('active');
          });
        }
        // TOC toggle button logic
        if (tocToggle && tocSidebar) {
          // Always hide TOC sidebar on load
          tocSidebar.classList.add('toc-hidden');
          tocToggle.addEventListener('click', function() {
            tocSidebar.classList.toggle('toc-hidden');
            tocSidebar.classList.toggle('active');
          });
        }
        // --- Table of Contents Sidebar Generation with Numbering (include all headings in TOC and content) ---
        const mainContent = document.querySelector('#main .inner');
        if (tocSidebar && mainContent) {
          const headings = mainContent.querySelectorAll('h1, h2, h3, h4');
          if (headings.length > 2) {
            let tocHtml = '<div class="toc-title">Table of Contents</div><ul class="toc-list">';
            let numbers = [0, 0, 0, 0]; // For h1-h4
            let tocNumbers = [0, 0, 0, 0]; // Separate numbering for TOC
            // Start from the first heading (index 0)
            for (let idx = 0; idx < headings.length; idx++) {
              const heading = headings[idx];
              const level = parseInt(heading.tagName.substring(1)) - 1; // 0-based
              // Update numbering for content
              numbers[level]++;
              for (let i = level + 1; i < numbers.length; i++) numbers[i] = 0;
              // Build number string for content
              let numberStr = numbers.slice(0, level + 1).filter(n => n > 0).join('.');
              // Prepend number to heading text
              let headingText = heading.textContent.replace(/^\d+(\.\d+)*\.\s*/, '');
              heading.innerHTML = `<span class=\"section-number\">${numberStr}.</span> ` + headingText;
              if (!heading.id) {
                heading.id = headingText.trim().toLowerCase().replace(/[^a-z0-9]+/g, '-');
              }
              // Add all headings to TOC
              tocNumbers[level]++;
              for (let i = level + 1; i < tocNumbers.length; i++) tocNumbers[i] = 0;
              let tocNumberStr = tocNumbers.slice(0, level + 1).filter(n => n > 0).join('.');
              tocHtml += `<li class=\"toc-level-${level+1}\"><a href=\"#${heading.id}\"><span class='section-number'>${tocNumberStr}.</span> ${headingText}</a></li>`;
            }
            tocHtml += '</ul>';
            tocSidebar.innerHTML = tocHtml;
            // Do NOT add .active or remove .toc-hidden here
          } else {
            tocSidebar.classList.add('toc-hidden'); // Hide if not enough headings
          }
        }
      });
    </script>

  </body>

</html>
  </body>

</html>
